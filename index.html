<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Moonwalk Mania</title>
    <link rel="stylesheet" href="styles.css" />
    <script>
      window.SUPABASE_URL = window.SUPABASE_URL || "";
      window.SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY || "";
    </script>
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar">
        <div class="profile-card" id="profileCard">
          <div class="avatar" id="profileAvatar">MJ</div>
          <div>
            <p class="profile-name" id="profileName">Guest Dancer</p>
            <p class="profile-status" id="profileStatus">Not signed in</p>
          </div>
          <button class="ghost" id="profileLoginButton">Login</button>
        </div>

        <div class="nav-section">
          <p class="nav-heading">Game</p>
          <button class="nav-item active" data-page="play">
            <span>‚ñ∂</span> Play
          </button>
          <button class="nav-item" data-page="learn">
            <span>‚ùì</span> Learn
          </button>
          <button class="nav-item" data-page="levels">
            <span>‚ö°</span> Levels
          </button>
          <button class="nav-item" data-page="tracks">
            <span>‚ô™</span> Tracks
          </button>
        </div>

        <div class="nav-section">
          <p class="nav-heading">Social</p>
          <button class="nav-item" data-page="leaderboard">
            <span>üèÜ</span> Leaderboard
          </button>
          <button class="nav-item" data-page="profile">
            <span>üë§</span> Profile
          </button>
        </div>

        <div class="nav-section">
          <p class="nav-heading">Support</p>
          <button class="nav-item" data-page="controls">
            <span>üéõ</span> Controls
          </button>
          <button class="nav-item" data-page="settings">
            <span>‚öô</span> Settings
          </button>
        </div>

        <div class="nav-section admin-section hidden" id="adminNavSection">
          <p class="nav-heading">Admin</p>
          <button class="nav-item" data-page="admin">
            <span>üõ†</span> Admin Console
          </button>
        </div>

        <div class="sidebar-footer">
          <button class="ghost" data-page="settings">Settings</button>
          <span class="version">v2.0.0</span>
        </div>
      </aside>

      <div class="main">
        <header class="topbar">
          <div class="status-chip" id="runStatus">Ready</div>
          <div class="topbar-meta">
            <div>
              <span class="label">Level</span>
              <span id="currentLevelLabel">Club Intro</span>
            </div>
            <div>
              <span class="label">Track</span>
              <span id="currentTrackLabel">Billie Jean</span>
            </div>
            <div>
              <span class="label">Orientation</span>
              <span id="layoutIndicator">Horizontal</span>
            </div>
            <div>
              <span class="label">Network</span>
              <span id="syncIndicator">Online</span>
            </div>
          </div>
          <div class="announcement" id="announcementBanner">Welcome to Moonwalk Mania.</div>
        </header>

        <main class="page-panel">
          <section class="page active" data-page="play">
            <div class="page-header">
              <div>
                <h1>Moonwalk Mania</h1>
                <p class="subtitle">Launch the dedicated Game Scene for a clean, osu!-style run.</p>
              </div>
              <div class="header-actions">
                <button class="primary" id="enterGameButton">Enter Game Scene</button>
              </div>
            </div>

            <div class="panel tutorial-panel">
              <div class="panel-header">
                <h2>Quick Tutorial</h2>
                <span class="hint">Start here</span>
              </div>
              <ul class="bullet-list">
                <li>Enter the Game Scene to play.</li>
                <li>Hit the next note on the line with arrows or WASD.</li>
                <li>Wrong direction breaks streak‚Äîtiming matters.</li>
              </ul>
            </div>

            <div class="play-grid">
              <div class="panel">
                <div class="panel-header">
                  <h2>Now Playing</h2>
                  <span class="hint" id="trackHint">Official preview</span>
                </div>
                <div class="track-embed" id="trackEmbed"></div>
                <div class="panel-row">
                  <span class="label">Level</span>
                  <span id="levelLabel">Club Intro</span>
                </div>
              </div>
              <div class="panel">
                <div class="panel-header">
                  <h2>Focus Rules</h2>
                  <span class="hint">No spam, no clutter</span>
                </div>
                <ul class="bullet-list">
                  <li>Only the next note can be hit.</li>
                  <li>Wrong key = miss and streak break.</li>
                  <li>Use Reset between level/track changes.</li>
                </ul>
              </div>
            </div>
          </section>

          <section class="page" data-page="learn">
            <div class="page-header">
              <div>
                <h1>Legend Learning Lab</h1>
                <p class="subtitle">Play the quiz and earn MJ facts.</p>
              </div>
              <div class="header-actions">
                <button class="primary" id="quizStartButton">Start Quiz</button>
                <button class="ghost" id="quizNextButton" disabled>Next Question</button>
              </div>
            </div>
            <div class="panel quiz-panel">
              <div class="quiz-stats">
                <div>
                  <span class="label">Quiz Score</span>
                  <span class="value" id="quizScore">0</span>
                </div>
                <div>
                  <span class="label">Streak</span>
                  <span class="value" id="quizStreak">0</span>
                </div>
              </div>
              <div class="quiz-question" id="quizQuestion">Press Start Quiz to begin.</div>
              <div class="quiz-choices" id="quizChoices"></div>
              <div class="quiz-feedback" id="quizFeedback">Ready to learn?</div>
            </div>
          </section>

          <section class="page" data-page="levels">
            <div class="page-header">
              <div>
                <h1>Levels</h1>
                <p class="subtitle">Choose a show intensity. Reset to apply if running.</p>
              </div>
            </div>
            <div class="panel" id="levelsPanel"></div>
          </section>

          <section class="page" data-page="tracks">
            <div class="page-header">
              <div>
                <h1>Tracks</h1>
                <p class="subtitle">MJ-only official previews.</p>
              </div>
            </div>
            <div class="panel" id="tracksPanel"></div>
          </section>

          <section class="page" data-page="leaderboard">
            <div class="page-header">
              <div>
                <h1>Global Leaderboards</h1>
                <p class="subtitle">Top performances per level.</p>
              </div>
              <div class="header-actions">
                <select id="leaderboardLevelSelect"></select>
              </div>
            </div>
            <div class="panel" id="leaderboardPanel"></div>
          </section>

          <section class="page" data-page="profile">
            <div class="page-header">
              <div>
                <h1>Profile & Login</h1>
                <p class="subtitle">Save your progress across devices.</p>
              </div>
            </div>
            <div class="panel profile-panel">
              <form id="authForm" class="form-grid">
                <label>
                  Email
                  <input type="email" id="authEmail" placeholder="you@example.com" />
                </label>
                <label>
                  Password
                  <input type="password" id="authPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
                </label>
                <div class="form-actions">
                  <button type="button" class="primary" id="loginButton">Login</button>
                  <button type="button" class="ghost" id="signupButton">Create Account</button>
                  <button type="button" class="ghost" id="googleButton">Google Login</button>
                  <button type="button" class="ghost" id="logoutButton">Logout</button>
                </div>
              </form>
              <div class="profile-settings">
                <label>
                  Display Name (max 16)
                  <input type="text" id="displayNameInput" maxlength="16" />
                </label>
                <label>
                  Favorite Track
                  <input type="text" id="favoriteTrackInput" />
                </label>
              </div>
            </div>
          </section>

          <section class="page" data-page="controls">
            <div class="page-header">
              <div>
                <h1>Controls</h1>
                <p class="subtitle">Keep it simple: arrows or WASD.</p>
              </div>
            </div>
            <div class="panel">
              <ul class="bullet-list">
                <li>Arrow keys or WASD to hit notes.</li>
                <li>Space toggles pause during play.</li>
                <li>Reset between level/track changes.</li>
              </ul>
            </div>
          </section>

          <section class="page" data-page="settings">
            <div class="page-header">
              <div>
                <h1>Settings</h1>
                <p class="subtitle">Tune the vibe and layout.</p>
              </div>
            </div>
            <div class="panel settings-panel">
              <div class="form-grid">
                <label>
                  Theme
                  <select id="themeSelect"></select>
                </label>
                <label>
                  Orientation
                  <select id="layoutSelect">
                    <option value="horizontal">Horizontal</option>
                    <option value="vertical">Vertical</option>
                  </select>
                </label>
                <label>
                  Note Size
                  <select id="noteSizeSelect">
                    <option value="small">Small</option>
                    <option value="medium" selected>Medium</option>
                    <option value="large">Large</option>
                  </select>
                </label>
                <label>
                  Lane Scale
                  <input type="range" id="laneScaleInput" min="0.9" max="1.2" step="0.05" />
                </label>
                <label>
                  FX Intensity
                  <select id="fxSelect">
                    <option value="low">Low</option>
                    <option value="medium" selected>Medium</option>
                    <option value="high">High</option>
                  </select>
                </label>
                <label>
                  Dancer
                  <select id="dancerSelect">
                    <option value="off">Off</option>
                    <option value="low" selected>Low</option>
                    <option value="high">High</option>
                  </select>
                </label>
                <label class="toggle">
                  <input type="checkbox" id="muteToggle" />
                  Mute audio
                </label>
                <label class="toggle">
                  <input type="checkbox" id="autoplayToggle" />
                  Autoplay preview (may be blocked)
                </label>
              </div>
              <p class="hint" id="settingsHint"></p>
            </div>
          </section>

          <section class="page" data-page="admin">
            <div class="page-header">
              <div>
                <h1>Admin Console</h1>
                <p class="subtitle">Draft, publish, and sync global changes.</p>
              </div>
            </div>
            <div class="panel admin-panel">
              <div class="admin-lock hidden" id="adminGate">
                <div>
                  <h2>Admin Access Required</h2>
                  <p class="subtitle">Authorized roles only. Unlock to view tools.</p>
                  <div class="admin-unlock">
                    <input type="password" id="adminUnlockInput" placeholder="Access code" />
                    <button class="primary" id="adminUnlockButton">Unlock</button>
                  </div>
                </div>
              </div>
              <div class="admin-header">
                <div>
                  <span class="label">Draft changes</span>
                  <span id="draftCount">0</span>
                </div>
                <div>
                  <span class="label">Published version</span>
                  <span id="publishedVersion">0</span>
                </div>
                <div class="admin-actions">
                  <button class="ghost" id="adminUndo">Undo</button>
                  <button class="primary" id="adminPublish">Publish</button>
                </div>
              </div>
              <div class="admin-grid">
                <div>
                  <div class="console">
                    <div class="console-log" id="adminLog"></div>
                    <div class="console-input">
                      <input type="text" id="adminCommand" placeholder="command" />
                      <button class="primary" id="adminRun">Run</button>
                      <button class="ghost" id="adminClear">Clear</button>
                    </div>
                  </div>
                </div>
                <div>
                  <div class="control-cards" id="adminControls"></div>
                </div>
              </div>
            </div>
          </section>
        </main>
      </div>
    </div>

    <div class="game-scene hidden" id="gameScene">
      <div class="setup-overlay" id="setupOverlay">
        <div class="setup-card">
          <div class="panel-header">
            <h2>Game Setup</h2>
            <span class="hint" id="setupRunHint">Choose settings before starting.</span>
          </div>
          <div class="setup-grid">
            <label>
              Track (MJ-only)
              <select id="setupTrackSelect"></select>
            </label>
            <label>
              Level
              <select id="setupLevelSelect"></select>
            </label>
            <label>
              Orientation
              <select id="setupLayoutSelect">
                <option value="horizontal">Horizontal</option>
                <option value="vertical">Vertical</option>
              </select>
            </label>
            <label>
              Theme
              <select id="setupThemeSelect"></select>
            </label>
            <label>
              Note Size
              <select id="setupNoteSizeSelect">
                <option value="small">Small</option>
                <option value="medium">Medium</option>
                <option value="large">Large</option>
              </select>
            </label>
            <label>
              Lane Scale
              <input type="range" id="setupLaneScaleInput" min="0.9" max="1.2" step="0.05" />
            </label>
            <label>
              FX Intensity
              <select id="setupFxSelect">
                <option value="low">Low</option>
                <option value="medium">Medium</option>
                <option value="high">High</option>
              </select>
            </label>
            <label>
              Dancer
              <select id="setupDancerSelect">
                <option value="off">Off</option>
                <option value="low">Low</option>
                <option value="high">High</option>
              </select>
            </label>
          </div>
          <div class="setup-player-mode">
            <button class="ghost" id="setupLoginButton">Sign Up / Log In</button>
            <button class="ghost" id="setupGuestButton">Play as Guest</button>
          </div>
          <div class="setup-actions">
            <button class="primary" id="startButton">Start Run</button>
          </div>
        </div>
      </div>
      <div class="game-topbar">
        <button class="ghost" id="exitGameButton">Exit to Menu</button>
        <div class="game-status">
          <span class="status-chip" id="gameRunStatus">Ready</span>
          <span class="game-status-meta" id="gameStatusMeta">Level 1 ¬∑ Billie Jean</span>
        </div>
      </div>
      <div class="game-hud">
        <div class="hud-card">
          <span class="label">Score</span>
          <span class="value" id="score">0</span>
        </div>
        <div class="hud-card">
          <span class="label">Streak</span>
          <span class="value" id="streak">0</span>
        </div>
        <div class="hud-card">
          <span class="label">Multiplier</span>
          <span class="value" id="multiplier">1.0x</span>
        </div>
        <div class="hud-card">
          <span class="label">Accuracy</span>
          <span class="value" id="accuracy">100%</span>
        </div>
        <div class="hud-card">
          <span class="label">Time</span>
          <span class="value" id="time">0</span>
        </div>
        <div class="hud-card">
          <span class="label">Level</span>
          <span class="value" id="hudLevel">Club Intro</span>
        </div>
        <div class="hud-card">
          <span class="label">Track</span>
          <span class="value" id="hudTrack">Billie Jean</span>
        </div>
      </div>
      <div class="game-body">
        <div class="game-playfield">
          <div class="lane" id="lane">
            <div class="hit-line"></div>
            <div class="hit-zone">HIT</div>
          </div>
          <div class="timing-feedback" id="timingFeedback">Press Start to begin.</div>
        </div>
        <div class="game-sidecard">
          <div class="panel-header">
            <h2>Character Showcase</h2>
            <span class="hint">MJ-inspired performer</span>
          </div>
          <div class="dancer-stage" id="dancerStage">
            <div class="dancer-silhouette" id="dancer"></div>
            <div class="stage-glow"></div>
          </div>
          <div class="panel-row">
            <span class="label">FX</span>
            <span id="fxIndicator">Medium</span>
          </div>
        </div>
      </div>
      <div class="game-controls">
        <button class="ghost" id="pauseButton" disabled>Pause</button>
        <button class="ghost" id="resetButton">Reset</button>
      </div>
    </div>

    <div class="modal hidden" id="summaryModal">
      <div class="modal-card">
        <h2>Show Summary</h2>
        <div class="summary-grid">
          <div><span class="label">Final Score</span><span id="summaryScore">0</span></div>
          <div><span class="label">Accuracy</span><span id="summaryAccuracy">0%</span></div>
          <div><span class="label">Max Streak</span><span id="summaryMaxStreak">0</span></div>
          <div><span class="label">Avg Multiplier</span><span id="summaryAvgMultiplier">1.0x</span></div>
          <div><span class="label">Notes Hit</span><span id="summaryNotes">0/0</span></div>
          <div><span class="label">Perfect</span><span id="summaryPerfect">0</span></div>
          <div><span class="label">Good</span><span id="summaryGood">0</span></div>
          <div><span class="label">Okay</span><span id="summaryOkay">0</span></div>
          <div><span class="label">Miss</span><span id="summaryMiss">0</span></div>
          <div><span class="label">Score Breakdown</span><span id="summaryBreakdown">0/0/0</span></div>
          <div><span class="label">Level</span><span id="summaryLevel">-</span></div>
          <div><span class="label">Track</span><span id="summaryTrack">-</span></div>
          <div><span class="label">Time Played</span><span id="summaryTime">0s</span></div>
          <div><span class="label">Personal Best</span><span id="summaryPersonalBest">-</span></div>
          <div><span class="label">Submission</span><span id="summarySubmit">Pending</span></div>
        </div>
        <div class="modal-actions">
          <button class="primary" id="summaryPlayAgain">Play Again</button>
          <button class="ghost" id="summaryBackLevels">Levels</button>
          <button class="ghost" id="summaryViewLeaderboard">Leaderboard</button>
          <button class="ghost" id="summaryClose">Close</button>
        </div>
      </div>
    </div>

    <script type="module" src="js/app.js"></script>
  </body>
</html>
